/*--------------------------------*- C++ -*----------------------------------*\
  =========                 |
  \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox
   \\    /   O peration     | Website:  https://openfoam.org
    \\  /    A nd           | Version:  7
     \\/     M anipulation  |
\*---------------------------------------------------------------------------*/
FoamFile
{
    version     2.0;
    format      ascii;
    class       dictionary;
    object      blockMeshDict;
}
// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //

convertToMeters 1e-5;

tan_theta 0.15; //Pipette wall angle/incline
a 5.5e-1;       //Inner insulator radius
d 2e-1;         //substrate distance
x_g 1.5;     //Outer insulator radius
L 5;         //Pipet domain height
x_s 5;       //Pipet domain width

y_top_pip_inner #calc "$a+($L-$d)*$tan_theta";
y_top_pip_outer #calc "$x_g+($L-$d)*$tan_theta";

//Variables to produce a wedge type mesh
eps 1e-2;
aa #calc "$a*$eps";
xx_s #calc "$x_s*$eps";
xx_g #calc "$x_g*$eps";
yy_top_pip_inner #calc "$y_top_pip_inner*$eps";
yy_top_pip_outer #calc "$y_top_pip_outer*$eps";
maa #calc "-$a*$eps";
mxx_s #calc "-$x_s*$eps";
mxx_g #calc "-$x_g*$eps";
myy_top_pip_inner #calc "-$y_top_pip_inner*$eps";
myy_top_pip_outer #calc "-$y_top_pip_outer*$eps";

vertices
(
    //Bottom left pipette block
    (0 0 0)
    ($a 0 $maa)
    ($a $d $maa)
    (0 $d 0)
    (0 0 1) //
    ($a 0 $aa)
    ($a $d $aa)
    (0 $d 1) //

    //Top face of top right pipette block
    ($y_top_pip_inner $L $myy_top_pip_inner)
    ($y_top_pip_inner $L $yy_top_pip_inner)
    (0 $L 1) //
    (0 $L 0)

    //Right face of bottom center pipette block
    ($x_g 0 $mxx_g)
    ($x_g $d $mxx_g)
    ($x_g $d $xx_g)
    ($x_g 0 $xx_g)

    //Front face (z=0) of top right pipette block
    ($x_s $d $mxx_s)
    ($x_s $L $mxx_s)
    ($y_top_pip_outer $L $myy_top_pip_outer)

    //Back face (z=1) of top right pipette block
    ($x_s $d $xx_s)
    ($x_s $L $xx_s)
    ($y_top_pip_outer $L $yy_top_pip_outer)

    //Bottom right vertices of bottom right pipette block
    ($x_s 0 $mxx_s)
    ($x_s 0 $xx_s)
);

blocks
(
    hex (0 1 2 3 0 5 6 3) (20 100 1) SimpleGrading (1 10 1) //Bottom left block
    hex (3 2 8 11 3 6 9 11) (20 200 1) SimpleGrading (1 0.5 1) //Top left block
    hex (1 12 13 2 5 15 14 6) (20 100 1) SimpleGrading (1 10 1) //Bottom center block
    hex (13 16 17 18 14 19 20 21) (20 100 1) SimpleGrading (1 1 1) //Top right block
    hex (12 22 16 13 15 23 19 14) (20 100 1) SimpleGrading (1 10 1) //Bottom right block
);

edges
(
);

boundary
(
    Inner_Pip_Wall
    {
        type wall;
        faces
        (
            (2 8 9 6)
        );
    }

    Outer_Pip_Wall
    {
        type wall;
        faces
        (
            (13 18 21 14)
            (2 13 14 6)
        );
    }


    Inner_Electrode
    {
        type inlet;
        faces
        (
            (11 8 9 11)
        );
    }

    Planar_Electrode
    {
        type wall;
        faces
        (
            (0 1 5 0)
            (1 12 15 5)
            (12 22 23 15)
        );
    }

    Symme_Axis_Left_Wall
    {
        type empty;
        faces
        (
            (0 3 3 0)
            (3 11 11 3)
        );
    }

    Outer_Walls
    {
        type wall;
        faces
        (
            (18 17 20 21)
            (22 16 19 23)
            (16 17 20 19)
        );
    }

    Front
    {
        type wedge;
        inGroups (FrontAndBack);
        faces
        (
            (0 1 2 3)
            (3 2 8 11)
            (1 12 13 2)
            (12 22 16 13)
            (13 16 17 18)
        );
    }

    Back
    {
        type wedge;
        inGroups (FrontAndBack);
        faces
        (
            (0 5 6 3)
            (3 6 9 11)
            (5 15 14 6)
            (15 23 19 14)
            (14 19 20 21)
        );
    }
);

mergePatchPairs
(
);

// ************************************************************************* //
